<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="${isAdmin ? 'PETOPIA - 관리자 로그인' : 'PETOPIA'}">자유게시판</title>
  <style>
    /* Reset and Global Styles */
    a, button, input, select, h1, h2, h3, h4, h5, * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        border: none;
        text-decoration: none;
        background: none;
        -webkit-font-smoothing: antialiased;
    }

    menu, ol, ul {
        list-style-type: none;
        margin: 0;
        padding: 0;
    }

    body {
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px 0;
            overflow: hidden;
        }

    .community {
            background: #ffffff;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            height: 852px;
            width: 414px;
            position: relative;
            overflow-y: auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .petopia {
        color: #000000;
        font-weight: 700;
        font-size: 20px;
    }

    .header {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        height: 49px;
        padding: 0 20px;
        position: sticky;
        top: 0;
        background: #ffffff;
        z-index: 100;
    }

    .header .icon-buttons {
        display: flex;
        gap: 16px;
    }

    .header .icon-button img {
        width: 24px;
        height: 24px;
        cursor: pointer;
    }

    .category-buttons {
        display: flex;
        gap: 8px;
        padding: 10px 20px;
        overflow-x: auto;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
    }
    
    .category-buttons a {
        padding: 6px 12px;
        border-radius: 15px;
        color: #666;
        background-color: #f5f5f5;
        font-size: 14px;
        transition: all 0.2s ease;
    }
    
    .category-buttons a:hover {
        background-color: #e0e0e0;
    }
    
    .category-buttons a.active {
        background-color: #4CAF50;
        color: white;
    }

    .frame-232 {
        display: flex;
        gap: 10px;
        padding: 15px 20px;
        overflow-x: auto;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
        background-color: #fff;
        border-top: 1px solid #eee;
        border-bottom: 1px solid #eee;
        width: 100%;
        position: sticky;
        top: 49px;
        z-index: 99;
    }

    .frame-232::-webkit-scrollbar {
        display: none;
    }

    .frame-232 > div {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-width: 60px;
        text-align: center;
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: background-color 0.2s;
    }

    .frame-232 > div:hover {
        background-color: #f5f5f5;
    }

    .frame-232 img {
        width: 24px;
        height: 24px;
        margin-bottom: 4px;
    }

    .div3, .div5, .div6, .div7, .div8, .div10 {
        font-size: 12px;
        color: #666;
        margin-top: 4px;
    }

    .posts-container {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      position: relative;
      height: calc(100vh - 180px); /* 헤더와 푸터 높이를 제외한 높이 */
    }

    #boardList {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding-bottom: 80px; /* 글쓰기 버튼 공간 확보 */
    }

    .board-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .board-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .board-content {
      flex: 1;
      margin-right: 16px;
    }

    .board-info {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .board-category {
      font-size: 12px;
      color: #666;
      background: #f5f5f5;
      padding: 4px 8px;
      border-radius: 4px;
    }

    .board-title {
      font-size: 16px;
      font-weight: 500;
      color: #333;
      margin-bottom: 8px;
    }

    .board-meta {
      display: flex;
      gap: 12px;
      font-size: 12px;
      color: #888;
      align-items: center;
    }

    .has-image {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .has-image img {
      width: 16px;
      height: 16px;
      opacity: 0.6;
    }

    .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 60px 20px;
        text-align: center;
        color: #666;
    }

    .empty-state img {
        width: 80px;
        height: 80px;
        margin-bottom: 16px;
        opacity: 0.6;
    }

    .empty-state .message {
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 8px;
        color: #333;
    }

    .empty-state .sub-message {
        font-size: 14px;
        color: #999;
        line-height: 1.4;
    }

    /* 하단 네비게이션 바 스타일 */
    .group-31 {
        position: fixed;
        bottom: 0;
        width: 100%;
        max-width: 414px;
        background: #FFFFFF;
        border-top: 1px solid #EEEEEE;
        padding: 10px 0;
        z-index: 1000;
    }

    .frame-31 {
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 0 20px;
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        cursor: pointer;
    }

    .nav-item img {
        width: 24px;
        height: 24px;
        opacity: 0.6;
        transition: opacity 0.2s;
    }

    .nav-item.active img {
        opacity: 1;
    }

    .nav-item span {
        font-size: 12px;
        color: #666666;
    }

    .nav-item.active span {
        color: #0C098C;
        font-weight: 500;
    }

    .notice {
        position: relative;
        background-color: #fffbea;
        border-left: 4px solid #ffcc00;
        padding: 10px 20px 10px 50px;
        margin-bottom: 10px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }

    .notice::before {
        content: '공지';
        position: absolute;
        top: 20%;
        left: 0%;
        transform: translateY(-50%);
        background-color: #ffcc00;
        color: #fff;
        padding: 2px 8px;
        border-radius: 3px;
        font-size: 12px;
        font-weight: bold;
    }

    /* 글쓰기 버튼 스타일 */
    .write-button {
      position: absolute;
      right: 20px;
      bottom: 90px;
      cursor: pointer;
    }

    .write-button img {
      width: 70px;
      height: 70px;
    }

    /* 관리자 공지사항 스타일 */
    .board-item.notice {
      background-color: #fff9e6;
      border-left: 4px solid #ffd700;
    }

    .board-item.notice .board-category {
      background-color: #ffd700;
      color: #000;
      font-weight: 500;
    }

    .board-item.notice .board-title {
      color: #000;
      font-weight: 600;
    }

    .board-item.notice .board-meta {
      color: #666;
    }
  </style>
</head>
<body>
  <div class="community">
    <div class="header">
        <div class="petopia">PETOPIA</div>
        <div class="icon-buttons">
            <div class="icon-button">
                <img src="/images/notification0.svg" alt="알림" onclick="location.href='/'">
            </div>
            <div class="icon-button">
                <img src="/images/group-500.svg" alt="마이페이지" onclick="location.href='/'">
            </div>
        </div>
    </div>

    <div class="frame-232">
        <div onclick="filterPosts('all')" class="active">
            <img src="/images/home-4-home-house-roof-shelter1.svg" alt="전체">
            <div class="div3">전체</div>
        </div>
        <div onclick="filterPosts('notice')">
            <img src="/images/volume.svg" alt="공지">
            <div class="div5">공지</div>
        </div>
        <div onclick="filterPosts('question')">
            <img src="/images/union0.svg" alt="질문">
            <div class="div6">질문</div>
        </div>
        <div onclick="filterPosts('free')">
            <img src="/images/chat-bubble-square-write-messages-message-bubble-chat-square-write-review-pen-pencil-compose1.svg" alt="자유">
            <div class="div7">자유</div>
        </div>
        <div onclick="filterPosts('share')">
            <img src="/images/coin-share-payment-cash-money-finance-receive-give-coin-hand1.svg" alt="나눔">
            <div class="div8">나눔</div>
        </div>
        <div onclick="filterPosts('event')">
            <img src="/images/gift-reward-box-social-present-gift-media-rating-bow1.svg" alt="이벤트">
            <div class="div10">이벤트</div>
        </div>
    </div>

    <div class="posts-container">
        <div id="boardList">
            <!-- 게시글 목록이 여기에 표시됩니다 -->
            <th:block th:each="board : ${boardList}">
                <div class="board-item" th:onclick="'location.href=\'/board/detail?id=' + ${board.bIdx} + '\''">
                    <div class="board-content">
                        <div class="board-info">
                            <span class="board-category" th:text="${board.bType}">카테고리</span>
                        </div>
                        <h3 class="board-title" th:text="${board.title}">제목</h3>
                        <div class="board-meta">
                            <span th:text="${board.member.name}">작성자</span>
                            <span th:text="${board.insertDate}">작성일</span>
                            <span class="has-image" th:if="${board.content.contains('[첨부파일]')}">
                                <img src="/images/image.svg" alt="이미지">
                                첨부파일
                            </span>
                        </div>
                    </div>
                </div>
            </th:block>
        </div>
    </div>

    <!-- 글쓰기 버튼 -->
    <div class="write-button" onclick="checkLoginAndWrite()" title="글쓰기">
        <img src="/images/write-button.svg" alt="글쓰기">
    </div>

    <!-- 하단 메뉴 -->
    <div class="group-31">
        <div class="frame-31">
            <div class="nav-item" onclick="location.href='/'">
                <img src="/images/home1.svg" alt="홈">
                <span>홈</span>
            </div>
            <div class="nav-item" onclick="location.href='/calendar'">
                <img src="/images/calendar0.svg" alt="캘린더">
                <span>캘린더</span>
            </div>
            <div class="nav-item" onclick="location.href='/walk'">
                <img src="/images/location0.svg" alt="산책">
                <span>산책</span>
            </div>
            <div class="nav-item active" onclick="location.href='/board'">
                <img src="/images/_3-user0.svg" alt="커뮤니티">
                <span>커뮤니티</span>
            </div>
            <div class="nav-item" onclick="toggleMenu()">
                <img src="/images/category0.svg" alt="메뉴">
                <span>메뉴</span>
            </div>
        </div>
    </div>
  </div>

  <script>
    function checkLoginAndWrite() {
        // 로그인 상태 확인
        const isLoggedIn = /*[[${session.isLoggedIn}]]*/ false;
        
        if (!isLoggedIn) {
            alert('로그인이 필요한 서비스입니다.');
            window.location.href = '/member/login';
            return;
        }
        
        // 로그인 상태면 글쓰기 페이지로 이동
        window.location.href = '/board/create';
    }

    function filterPosts(type) {
        // 모든 카테고리 버튼의 active 클래스 제거
        document.querySelectorAll('.frame-232 > div').forEach(div => {
            div.classList.remove('active');
        });
        
        // 클릭된 버튼에 active 클래스 추가
        event.currentTarget.classList.add('active');
        
        // 카테고리에 따른 URL 설정
        let url = '/board';
        if (type !== 'all') {
            const categoryMap = {
                'notice': '공지사항',
                'event': '이벤트',
                'question': '질문',
                'free': '자유',
                'share': '나눔'
            };
            url += '?category=' + categoryMap[type];
        }
        
        // 페이지 이동
        window.location.href = url;
    }
    
    // 현재 카테고리에 따라 버튼 활성화
    document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const category = urlParams.get('category');
        
        const reverseMap = {
            '공지사항': 'notice',
            '이벤트': 'event',
            '질문': 'question',
            '자유': 'free',
            '나눔': 'share'
        };
        
        const type = category ? reverseMap[category] : 'all';
        const targetDiv = document.querySelector(`.frame-232 > div[onclick="filterPosts('${type}')"]`);
        if (targetDiv) {
            document.querySelectorAll('.frame-232 > div').forEach(div => {
                div.classList.remove('active');
            });
            targetDiv.classList.add('active');
        }
    });

    function toggleMenu() {
        // 메뉴 토글 구현
    }
  </script>
</body>
</html>